---
// Layout component that wraps around pages and blog posts, providing consistent structure and styling. you can read more about it here: https://docs.astro.build/en/guides/layouts/

import type { CollectionEntry } from "astro:content";

import { COLLECTION_NAMES_LIST } from "src/alkaline.config";

import { getEntry, render } from "astro:content";
import { Image } from "astro:assets";

import Layout from "@layouts/Layout.astro";
import Tags from "@components/Astro/Tags.astro";
import Author from "@components/Astro/Author.astro";

interface Props {
  collectionName: (typeof COLLECTION_NAMES_LIST)[number];
  postId: string | number;
  tags: string[] | undefined | null;
  class?: string | undefined;
}

const { class: className, collectionName, postId } = Astro.props;

const options = { "rounded-theme": true };

const entry:
  | CollectionEntry<(typeof COLLECTION_NAMES_LIST)[number]>
  | undefined = await getEntry(collectionName, String(postId));

if (!entry) {
  return new Response(null, {
    status: 404,
    statusText: "Not found",
  });
}

const { Content } = await render(entry);
---

<Layout
  title={entry.data.title}
  description={entry.data.description}
>
  <section class="mt-0 mb-8">
    <div class="rounded-xl bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white shadow-lg mb-8">
      <h1 class="text-4xl font-extrabold mb-2 drop-shadow-lg">{entry.data.title}</h1>
      {entry.data.subtitle && <p class="text-xl font-medium mb-4 opacity-90">{entry.data.subtitle}</p>}
      <div class="flex items-center gap-4 mb-4">
        <Author authorId={entry.data.authorId} pubDateTime={entry.data.pubDatetime} />
        {entry.data.tags && (
          <span class="flex items-baseline">
            <Tags tags={entry.data.tags} class="ml-2" />
          </span>
        )}
      </div>
      {entry.data.cover && (
        <Image
          src={entry.data.cover.src}
          alt={entry.data.cover.alt || entry.data.title}
          class:list={[
            "w-full h-auto max-h-[20rem] object-cover rounded-lg border-4 border-white shadow-md",
            options,
          ]}
          width={600}
        />
      )}
    </div>
    <article class:list={["prose", className]}>
      <Content />
    </article>
  </section>
</Layout>
